{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/kasir/OneDrive/Documents/srilatha kasireddy/Quizme-frontend/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/kasir/OneDrive/Documents/srilatha kasireddy/Quizme-frontend/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/kasir/OneDrive/Documents/srilatha kasireddy/Quizme-frontend/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import jwt from\"jsonwebtoken\";import\"./History.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function History(){var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),errorMsg=_useState6[0],setErrorMsg=_useState6[1];useEffect(function(){var token=localStorage.getItem(\"token\");if(token){var _data=jwt.decode(token);if(!_data.email){localStorage.removeItem(\"token\");navigate(\"/login\");}if(Date.now()>jwt.decode(token).exp*1000){localStorage.removeItem(\"token\");navigate(\"/login\");}else{getHistory();}}else{localStorage.removeItem(\"token\");navigate(\"/login\");}},[]);function getHistory(){return _getHistory.apply(this,arguments);}function _getHistory(){_getHistory=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var req,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:5000/api/history\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",\"x-auth-token\":localStorage.getItem(\"token\")}});case 2:req=_context.sent;_context.next=5;return req.json();case 5:data=_context.sent;if(data.status===\"ok\"){setError(false);setData(data.data);}else{setError(true);setErrorMsg(data.message);navigate(\"/login\");}case 7:case\"end\":return _context.stop();}}},_callee);}));return _getHistory.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"heading\",children:\" Quiz App\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"data\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"heading2\",children:\"Hers's Your Quiz History\"}),data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"data-item\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"date\",children:[\"Taken on \",new Date(item.date).toLocaleString(undefined,{timeZone:'Asia/Kolkata'})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Category\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:item.category})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Difficulty\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:item.difficulty})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"Score\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:item.score})]})]},item._id);}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:function onClick(){return navigate(\"/\");},children:\"Back\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errorMsg})]})]});}export default History;","map":{"version":3,"sources":["C:/Users/kasir/OneDrive/Documents/srilatha kasireddy/Quizme-frontend/client/src/components/History.jsx"],"names":["React","useState","useEffect","useNavigate","jwt","History","navigate","data","setData","error","setError","errorMsg","setErrorMsg","token","localStorage","getItem","decode","email","removeItem","Date","now","exp","getHistory","fetch","method","headers","req","json","status","message","map","item","date","toLocaleString","undefined","timeZone","category","difficulty","score","_id"],"mappings":"udAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,WAAT,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,GAAP,KAAgB,cAAhB,CACA,MAAO,eAAP,C,wFAEA,QAASC,CAAAA,OAAT,EAAmB,CACjB,GAAMC,CAAAA,QAAQ,CAAEH,WAAW,EAA3B,CACA,cAAwBF,QAAQ,CAAC,EAAD,CAAhC,wCAAOM,IAAP,eAAaC,OAAb,eACA,eAA0BP,QAAQ,CAAC,KAAD,CAAlC,yCAAOQ,KAAP,eAAcC,QAAd,eACA,eAAgCT,QAAQ,CAAC,EAAD,CAAxC,yCAAOU,QAAP,eAAiBC,WAAjB,eAEAV,SAAS,CAAC,UAAM,CACd,GAAMW,CAAAA,KAAK,CAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd,CACA,GAAIF,KAAJ,CAAW,CACT,GAAMN,CAAAA,KAAI,CAAGH,GAAG,CAACY,MAAJ,CAAWH,KAAX,CAAb,CACA,GAAI,CAACN,KAAI,CAACU,KAAV,CAAiB,CACfH,YAAY,CAACI,UAAb,CAAwB,OAAxB,EACAZ,QAAQ,CAAC,QAAD,CAAR,CACD,CACD,GAAIa,IAAI,CAACC,GAAL,GAAahB,GAAG,CAACY,MAAJ,CAAWH,KAAX,EAAkBQ,GAAlB,CAAwB,IAAzC,CAA+C,CAC7CP,YAAY,CAACI,UAAb,CAAwB,OAAxB,EACAZ,QAAQ,CAAC,QAAD,CAAR,CACD,CAHD,IAGO,CACLgB,UAAU,GACX,CACF,CAZD,IAYO,CACLR,YAAY,CAACI,UAAb,CAAwB,OAAxB,EACAZ,QAAQ,CAAC,QAAD,CAAR,CACD,CACF,CAlBQ,CAkBN,EAlBM,CAAT,CANiB,QA0BFgB,CAAAA,UA1BE,wIA0BjB,sKACoBC,CAAAA,KAAK,CAAC,mCAAD,CAAsC,CAC3DC,MAAM,CAAE,KADmD,CAE3DC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEP,eAAgBX,YAAY,CAACC,OAAb,CAAqB,OAArB,CAFT,CAFkD,CAAtC,CADzB,QACQW,GADR,qCASqBA,CAAAA,GAAG,CAACC,IAAJ,EATrB,QASQpB,IATR,eAUE,GAAIA,IAAI,CAACqB,MAAL,GAAgB,IAApB,CAA0B,CACxBlB,QAAQ,CAAC,KAAD,CAAR,CACAF,OAAO,CAACD,IAAI,CAACA,IAAN,CAAP,CACD,CAHD,IAGO,CACLG,QAAQ,CAAC,IAAD,CAAR,CACAE,WAAW,CAACL,IAAI,CAACsB,OAAN,CAAX,CACAvB,QAAQ,CAAC,QAAD,CAAR,CACD,CAjBH,sDA1BiB,6CA8CjB,mBACE,oCACE,WAAI,SAAS,CAAC,SAAd,uBADF,cAEE,aAAK,SAAS,CAAC,MAAf,wBACE,WAAI,SAAS,CAAC,UAAd,sCADF,CAEGC,IAAI,CAACuB,GAAL,CAAS,SAACC,IAAD,qBACR,aAAK,SAAS,CAAC,WAAf,wBACE,YAAI,SAAS,CAAC,MAAd,uBACU,GAAIZ,CAAAA,IAAJ,CAASY,IAAI,CAACC,IAAd,EAAoBC,cAApB,CAAmCC,SAAnC,CAA8C,CAACC,QAAQ,CAAE,cAAX,CAA9C,CADV,GADF,cAIE,YAAI,SAAS,CAAC,MAAd,wBACE,aAAM,SAAS,CAAC,OAAhB,sBADF,cAEE,aAAM,SAAS,CAAC,OAAhB,UAAyBJ,IAAI,CAACK,QAA9B,EAFF,GAJF,cAQE,YAAI,SAAS,CAAC,MAAd,wBACE,aAAM,SAAS,CAAC,OAAhB,wBADF,cAEE,aAAM,SAAS,CAAC,OAAhB,UAAyBL,IAAI,CAACM,UAA9B,EAFF,GARF,cAYE,YAAI,SAAS,CAAC,MAAd,wBACE,aAAM,SAAS,CAAC,OAAhB,mBADF,cAEE,aAAM,SAAS,CAAC,OAAhB,UAAyBN,IAAI,CAACO,KAA9B,EAFF,GAZF,GAAgCP,IAAI,CAACQ,GAArC,CADQ,EAAT,CAFH,cAqBE,eAAQ,SAAS,CAAC,KAAlB,CAAwB,OAAO,CAAE,yBAAMjC,CAAAA,QAAQ,CAAC,GAAD,CAAd,EAAjC,kBArBF,CAwBGG,KAAK,eAAI,YAAK,SAAS,CAAC,OAAf,UAAwBE,QAAxB,EAxBZ,GAFF,GADF,CA+BD,CAED,cAAeN,CAAAA,OAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate} from \"react-router-dom\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport \"./History.css\";\r\n\r\nfunction History() {\r\n  const navigate= useNavigate();\r\n  const [data, setData] = useState([]);\r\n  const [error, setError] = useState(false);\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (token) {\r\n      const data = jwt.decode(token);\r\n      if (!data.email) {\r\n        localStorage.removeItem(\"token\");\r\n        navigate(\"/login\");\r\n      }\r\n      if (Date.now() > jwt.decode(token).exp * 1000) {\r\n        localStorage.removeItem(\"token\");\r\n        navigate(\"/login\");\r\n      } else {\r\n        getHistory();\r\n      }\r\n    } else {\r\n      localStorage.removeItem(\"token\");\r\n      navigate(\"/login\");\r\n    }\r\n  }, []);\r\n\r\n  async function getHistory() {\r\n    const req = await fetch(\"http://localhost:5000/api/history\", {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"x-auth-token\": localStorage.getItem(\"token\"),\r\n      },\r\n    });\r\n\r\n    const data = await req.json();\r\n    if (data.status === \"ok\") {\r\n      setError(false);\r\n      setData(data.data);\r\n    } else {\r\n      setError(true);\r\n      setErrorMsg(data.message);\r\n      navigate(\"/login\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"heading\"> Quiz App</h1>\r\n      <div className=\"data\">\r\n        <h2 className=\"heading2\">Hers's Your Quiz History</h2>\r\n        {data.map((item) => (\r\n          <div className=\"data-item\" key={item._id}>\r\n            <h3 className=\"date\">\r\n            Taken on {new Date(item.date).toLocaleString(undefined, {timeZone: 'Asia/Kolkata'})}\r\n            </h3>\r\n            <h3 className=\"info\">\r\n              <span className=\"title\">Category</span>\r\n              <span className=\"value\">{item.category}</span>\r\n            </h3>\r\n            <h3 className=\"info\">\r\n              <span className=\"title\">Difficulty</span>\r\n              <span className=\"value\">{item.difficulty}</span>\r\n            </h3>\r\n            <h3 className=\"info\">\r\n              <span className=\"title\">Score</span>\r\n              <span className=\"value\">{item.score}</span>\r\n            </h3>\r\n          </div>\r\n        ))}\r\n        <button className=\"btn\" onClick={() => navigate(\"/\")}>\r\n            Back\r\n        </button>\r\n        {error && <div className=\"error\">{errorMsg}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default History;\r\n"]},"metadata":{},"sourceType":"module"}